% Dane Pary wodnej nasyconej 
Pkr = 22.115; Tkr = 647.3; Vkr=56.64; rokr=18.e3/Vkr;
% P T VL VV ro]
PTVro=[980.1	6.698	0.0010001	131.6	0.007599; ...
1471.0	12.737	0.0010006	89.63	0.01116; ...
1961.3	17.204	0.0010013	63.25	0.01565; ...
2451.7	20.776	0.0010027	46.52	0.02050; ...
2942.0	23.772	0.0010034	40.22	0.02486; ...
3432.3	26.359	0.0010040	35.46	0.02820; ...
3922.7	28.641	0.0010046	31.71	0.03154; ...
4413.0	30.69	0.0010052	28.72	0.03482; ...
4903.3	32.55	0.0010058	26.26	0.03808; ...
5393.7	35.82	0.0010063	24.19	0.04134; ...
5894.0	37.29	0.0010069	23.95	0.04358; ...
6374.3	38.66	0.0010069	22.45	0.04508; ...
6864.7	39.95	0.0010074	20.91	0.04782; ...
7355.0	41.16	0.0010079	19.59	0.05105; ...
7845.3	42.32	0.0010084	18.45	0.05420; ...
8335.7	43.41	0.0010088	17.41	0.05744; ...
8826.0	44.46	0.0010093	16.50	0.06061; ...
9316.3	44.46	0.0010097	15.68	0.06378; ...
9806.7	45.45	0.0010101	14.95	0.06689; ...
10787.3	47.33	0.0010109	13.66	0.07321; ...
11768.0	49.06	0.0010117	12.59	0.07943; ...
12748.7	50.67	0.0010124	11.67	0.08562; ...
13729.3	52.18	0.0010131	10.89	0.09183; ...
14710.0	53.60	0.0010138	10.20	0.09804; ...
15690.6	54.94	0.0010145	9.603	0.1041; ...
16671.3	56.21	0.0010151	9.073	0.1102; ...
17652.0	57.41	0.0010157	8.601	0.1163; ...
18632.6	58.57	0.0010163	8.172	0.1224; ...
19613.3	59.67	0.0010169	7.789	0.1284; ...
20594.0	60.72	0.0010175	7.442	0.1344; ...
21574.6	61.74	0.0010181	7.122	0.1404; ...
22555.3	62.71	0.0010186	6.833	0.1464; ...
23536.0	63.65	0.0010191	6.565	0.1523; ...
24516.6	64.56	0.0010196	6.318	0.1583; ...
25497.3	65.44	0.0010202	6.318	0.1643; ...
26477.9	66.29	0.0010206	5.876	0.1702; ...
27458.6	67.11	0.0010211	5.679	0.1761; ...
28439.3	67.91	0.0010216	5.495	0.1820; ...
29419.9	68.68	0.0010220	5.324	0.1878; ...
31381.3	70.16	0.0010229	5.013	0.1995; ...
33342.6	71.57	0.0010237	4.736	0.2112; ...
35303.9	72.91	0.0010245	4.489	0.2228; ...
37265.3	74.19	0.0010253	4.267	0.2344; ...
39226.6	75.42	0.0010261	4.066	0.2459; ...
44129.9	78.27	0.0010279	3.641	0.2746; ...
49033.2	80.86	0.0010296	3.299	0.3031; ...
53936.6	83.25	0.0010312	3.017	0.3315; ...
58839.9	85.45	0.0010327	2.782	0.3595; ...
63743.2	87.51	0.0010341	2.581	0.3875; ...
68646.5	89.45	0.0010355	2.408	0.4153; ...
73549.9	91.27	0.0010368	2.257	0.4431; ...
78455.2	92.99	0.0010381	2.125	0.4706; ...
83356.5	94.62	0.0010381	2.125	0.4936; ...
88259.8	96.18	0.0010405	1.903	0.5255; ...
93163.2	97.66	0.0010417	1.810	0.5525; ...
98066.5	99.09	0.0010428	1.725	0.5797; ...
107873.1	101.76	0.0010448	1.578	0.6337; ...
117679.8	104.25	0.0010468	1.455	0.6873; ...
127486.4	106.56	0.0010487	1.350	0.7407; ...
137293.1	108.74	0.0010505	1.259	0.7943; ...
147098.7	110.79	0.0010522	1.181	0.8467; ...
156906.4	112.73	0.0010538	1.111	0.9001; ...
166713.0	114.57	0.0010554	1.050	0.9524; ...
176519.7	116.33	0.0010570	0.9954	1.0046; ...
186326.3	118.01	0.0010585	0.9462	1.0570; ...
196133.0	119.62	0.0010600	0.9018	1.109; ...
205939.6	121.16	0.0010614	0.8616	1.161; ...
215746.3	122.65	0.0010627	0.8248	1.212; ...
225552.9	124.08	0.0010640	0.7912	1.264; ...
235359.6	125.46	0.0010653	0.7603	1.315; ...
245166.2	126.79	0.0010666	0.7318	1.367; ...
254972.9	128.08	0.0010678	0.7055	1.417; ...
264779.5	129.34	0.0010691	0.6808	1.469; ...
274586.2	130.55	0.0010703	0.6581	1.520; ...
284592.8	131.73	0.0010714	0.6368	1.570; ...
294199.5	132.88	0.0010726	0.6169	1.621; ...
304006.1	134.00	0.0010737	0.5982	1.672; ...
313812.8	135.06	0.0010748	0.5807	1.722; ...
323619.4	136.14	0.0010758	0.5645	1.772; ...
333426.1	137.18	0.0010769	0.5486	1.823; ...
343232.7	138.19	0.0010779	0.5338	1.873; ...
353039.4	139.18	0.0010800	0.5066	1.974; ...
362846.0	140.15	0.0010800	0.5066	1.974; ...
372652.7	141.09	0.0010809	0.4942	2.024; ...
382459.3	142.02	0.0010819	0.4822	2.074; ...
392266.0	142.92	0.0010829	0.4709	2.124; ...
402072.6	143.81	0.0010838	0.4601	2.173; ...
411879.3	144.68	0.0010847	0.4498	2.223; ...
421685.9	145.54	0.0010857	0.4399	2.273; ...
431492.6	146.38	0.0010866	0.4305	2.323; ...
441299.2	147.20	0.0010875	0.4215	2.373; ...
451105.9	148.01	0.0010884	0.4129	2.422; ...
460912.5	148.80	0.0010893	0.4045	2.472; ...
470719.2	149.59	0.0010902	0.3966	2.521; ...
480525.8	150.36	0.0010910	0.3890	2.571; ...
490332.5	151.11	0.0010918	0.3817	2.620; ...
509945.8	152.59	0.0010935	0.3679	2.718; ...
529559.1	154.02	0.0010951	0.3550	2.817; ...
549172.4	155.41	0.0010967	0.3431	2.915; ...
568785.7	156.76	0.0010983	0.3319	3.013; ...
588399.0	158.08	0.0010998	0.3214	3.111; ...
608012.3	159.36	0.0011013	0.3116	3.209; ...
627625.6	160.61	0.0011028	0.3024	3.307; ...
647238.9	161.82	0.0011043	0.2938	3.404; ...
666852.2	163.01	0.0011057	0.2856	3.501; ...
686465.5	164.17	0.0011071	0.2778	3.600; ...
706078.3	165.31	0.0011085	0.2705	3.697; ...
725692.1	166.42	0.0011099	0.2636	3.794; ...
745305.4	167.51	0.0011113	0.2570	3.891; ...
764918.7	168.57	0.0011126	0.2507	3.989; ...
804145.3	170.63	0.0011152	0.2391	4.182; ...
823758.6	171.63	0.0011165	0.2337	4.279; ...
843371.9	172.61	0.0011177	0.2286	4.375; ...
862985.2	173.58	0.0011189	0.2236	4.472; ...
882598.5	174.53	0.0011202	0.2189	4.568; ...
902211.8	175.46	0.0011214	0.2144	4.664; ...
921825.1	176.38	0.0011226	0.2100	4.762; ...
941438.4	177.28	0.0011238	0.2058	4.859; ...
961051.7	178.16	0.0051250	0.2019	4.953; ...
980665.0	179.04	0.0011262	0.1980	5.051; ...
1029698	181.16	0.0011291	0.1890	5.291; ...
1078731	183.20	0.0011319	0.1808	5.531; ...
1127764	185.17	0.0011346	0.1733	5.770; ...
1176798	187.08	0.0011373	0.1663	6.013; ...
1225831	188.92	0.0011399	0.1599	6.254; ...
1274864	190.71	0.0011426	0.1540	6.494; ...
1323897	192.45	0.0011451	0.1485	6.734; ...
1372931	194.13	0.0011476	0.1434	6.974; ...
1421964	195.77	0.0011501	0.1387	7.210; ...
1470997	197.36	0.0011525	0.1342	7.452; ...
1520030	198.91	0.0011548	0.1300	7.692; ...
1569064	200.43	0.0011572	0.1261	7.930; ...
1618097	201.91	0.0011595	0.1224	8.170; ...
1667130	203.35	0.0011618	0.1189	8.410; ...
1716163	204.76	0.0011640	0.1156	8.651; ...
1765197	206.14	0.0011662	0.1125	8.889; ...
1814230	207.49	0.0011684	0.1095	9.132; ...
1863263	208.81	0.0011706	0.1067	9.372; ...
1912296	210.11	0.0011728	0.1040	9.615; ...
1961330	211.38	0.0011749	0.1015	9.852];
% -------------------
w=760/1.033; %*1.e-4/10.102; 9.81; 
PvTJ=[4.58 0 0.0049; 9.2 10 0.0094; 17.5 20 0.0172; 31.8 30 0.0302; 55.3 40 0.0511; ...
      92.5 50 0.0831; 149.4 60 0.131; 760 100 0.604; 1.461*w 110 0.835; 2.024*w 120 1.13; ...
      2.754*w 130 1.52; 3.685*w 140 1.99; 4.854*w 150 2.58; 15.857*w 200 7.81; 40.56*w 250 20; ...
      87.61*w 300 46; 169.63*w 350 114];
PvJ=PvTJ(:,1)*0.1013/760; TJ=PvTJ(:,2)+273.16; ldp=length(PvJ); 
PTVro(:,2)=PTVro(:,2)+273.16; PTVro(:,1)=PTVro(:,1)*1.e-6; 
Pvd=[PTVro(:,1); PvJ(ldp-2); PvJ(ldp-1); PvJ(ldp); Pkr];
Rod=[PTVro(:,5); PvTJ(ldp-2,3); PvTJ(ldp-1,3); PvTJ(ldp,3); rokr];

y=log(Pvd);  
Td=[PTVro(:,2); TJ(ldp-2); TJ(ldp-1); TJ(ldp); Tkr];
x=Tkr./Td; 
K=4; aa=polyfit(x,y,K); A0=aa(K+1); A1=aa(K); A2=aa(K-1); A3=aa(K-2); A4=aa(K-3); 
PV=exp(A4*x.^4+A3.*x.^3+A2.*x.^2+A1.*x+A0); 
A=11.1128; PVs=exp(11.1128-5001.28/Tkr.*x);
PVs2=exp(11.2434 - 5050.*x);

figure; subplot(2,1,1), 
plot(PTVro(:,2), PTVro(:,1),'k', Td, PV,'r--', Td, PVs,'g:', TJ,PvJ,'b.',Tkr,Pkr,'b*'); 
xlabel('Cisnienie pary nasyconej vs. T (k-Pv_d; r-Pv_{mod}; b-Pv_{Ant})'); ylabel('Pv')
axis('tight')
%1./PTVro(:,4)-PTVro(:,5);
Vm=8.31.*[PTVro(:,2); Tkr]./[PTVro(:,1); Vkr]/18*1.e-3; roG=1./Vm; 
Vm=8.31.*Td./Rod/18*1.e-3; roG=1./Vm; 

subplot(2,1,2), plot(PTVro(:,2), PTVro(:,5),'k',Td, roG,'r:', TJ,PvTJ(:,3),'b.',Tkr,rokr,'b*'), axis('tight')
xlabel('Gestosc pary nasyconej vs. T (k-ro_d; r-ro_{gaz}'); ylabel('\ro')
